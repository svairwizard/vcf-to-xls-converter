# vcf-to-xlsx

Утилита на Python для конвертации контактных файлов в формате vCard (`.vcf`) в таблицу Excel (`.xlsx`). Она поддерживает базовые поля контакта, телефоны и Telegram‑ссылки, экспортируемые из iOS (Apple Contacts). [web:19][web:48]

## Возможности

- Чтение файлов vCard версии 3.0 (`.vcf`). [web:19]
- Извлечение:
  - полного имени контакта (FN / N);
  - номеров телефонов (несколько на контакт);
  - ссылки на Telegram (`itemN.URL` с меткой `itemN.X-ABLabel:Telegram` из экспорта iOS). [web:46]
- Экспорт в Excel‑файл (`.xlsx`) с колонками:
  - `FullName`
  - `Phone1`, `Phone2`, `Phone3`
  - `TelegramUrl` (и опционально `TelegramHandle`, если нужно). [web:18]

## Требования

- Python 3.8+
- Библиотека `openpyxl` для записи `.xlsx`. [web:11]

Установка зависимостей:

```shell
pip install openpyxl
```


## Использование

1. Экспортируйте контакты из телефона или почтового клиента в файл `contacts.vcf` (формат vCard 3.0). [web:18]
2. Поместите файл `contacts.vcf` рядом со скриптом `vcf_to_xls.py` (или измените константу `VCF_PATH` в коде на свой путь).
3. Запустите скрипт:

```shell 
python3 vcf_to_xls.py
```


4. В текущей папке появится файл `contacts.xlsx`, который можно открыть в Excel, Numbers, LibreOffice или другом табличном редакторе. [web:18]

## Формат данных в Excel

По одной строке на каждый контакт. Структура колонок:

- `FullName` — полное имя контакта.
- `Phone1`, `Phone2`, `Phone3` — до трёх телефонных номеров из vCard.
- `TelegramUrl` — полная ссылка вида `https://t.me/username` или `https://t.me/@id123456789`, извлечённая из `itemN.URL` с меткой `Telegram`. [web:46]
- `TelegramHandle` (если включён в код) — часть ссылки после `t.me/`, удобная для копирования или использования как логин в Telegram. [web:51]

## Ограничения и возможные доработки

- Парсер упрощён и ориентирован на типичный экспорт из iOS / Apple Contacts, использующий расширения `itemN.*` и метки `X-ABLabel`. [web:46][web:48]
- Для нестандартных полей или других клиентов (Android/Google, CRM и т.п.) при необходимости можно:
  - добавить разбор других свойств `URL`, `IMPP`, `X-TELEGRAM` и аналогичных полей; [web:23]
  - увеличить число телефонных колонок;
  - добавить экспорт сразу в CSV или другой формат.

Все изменения логики парсинга вносятся в функцию обработки строк `.vcf`, а состав и порядок колонок настраиваются в функции экспорта в Excel.
